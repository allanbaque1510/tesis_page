import{r,A as je,_ as fe,g as pe,m as be,f as Ce,n as X,C as ye,h as ve,b as J,j as e,U as oe,B as z,c as G,d as y,e as q,V as Se,x as ke,T as ue}from"./index-21055db3.js";import{U as v,A as ce}from"./UtilService-c94d23f7.js";import{F as f,C as M}from"./index-6fd6f147.js";import{R as F}from"./row-36c7c26f.js";import{I as me}from"./index-680fd5a3.js";import{S as W,C as N,a as L,E as Q,b as ne,T as he}from"./index-7fa0c08c.js";import{B as R}from"./index-3342eff1.js";import{C as _,T as xe,a as le,R as Le}from"./Table-99b5c404.js";import{T as de}from"./index-28b2f492.js";import{E as Me}from"./EditOutlined-747367f7.js";import"./BaseInput-9763bb7b.js";import"./TextArea-1e7806d6.js";import"./EyeOutlined-6816cc68.js";import"./styleChecker-2da1bf7b.js";import"./scrollTo-c5b2038a.js";import"./useForceUpdate-c784bdaf.js";var Fe={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112c17.7 0 32 14.3 32 32v736c0 17.7-14.3 32-32 32H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32zM639.98 338.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-square",theme:"filled"};const Ae=Fe;var we=function(a,x){return r.createElement(je,fe({},a,{ref:x,icon:Ae}))},Ee=r.forwardRef(we);const Ie=Ee,$e=t=>{const{componentCls:a,sizePaddingEdgeHorizontal:x,colorSplit:l,lineWidth:o,textPaddingInline:j,orientationMargin:i,verticalMarginInline:h}=t;return{[a]:Object.assign(Object.assign({},Ce(t)),{borderBlockStart:`${X(o)} solid ${l}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:h,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:`${X(o)} solid ${l}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${X(t.dividerHorizontalGutterMargin)} 0`},[`&-horizontal${a}-with-text`]:{display:"flex",alignItems:"center",margin:`${X(t.dividerHorizontalWithTextGutterMargin)} 0`,color:t.colorTextHeading,fontWeight:500,fontSize:t.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${l}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${X(o)} solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${a}-with-text-left`]:{"&::before":{width:`calc(${i} * 100%)`},"&::after":{width:`calc(100% - ${i} * 100%)`}},[`&-horizontal${a}-with-text-right`]:{"&::before":{width:`calc(100% - ${i} * 100%)`},"&::after":{width:`calc(${i} * 100%)`}},[`${a}-inner-text`]:{display:"inline-block",paddingBlock:0,paddingInline:j},"&-dashed":{background:"none",borderColor:l,borderStyle:"dashed",borderWidth:`${X(o)} 0 0`},[`&-horizontal${a}-with-text${a}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${a}-dashed`]:{borderInlineStartWidth:o,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${a}-with-text`]:{color:t.colorText,fontWeight:"normal",fontSize:t.fontSize},[`&-horizontal${a}-with-text-left${a}-no-default-orientation-margin-left`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${a}-inner-text`]:{paddingInlineStart:x}},[`&-horizontal${a}-with-text-right${a}-no-default-orientation-margin-right`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${a}-inner-text`]:{paddingInlineEnd:x}}})}},Pe=t=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:t.marginXS}),ze=pe("Divider",t=>{const a=be(t,{dividerHorizontalWithTextGutterMargin:t.margin,dividerHorizontalGutterMargin:t.marginLG,sizePaddingEdgeHorizontal:0});return[$e(a)]},Pe,{unitless:{orientationMargin:!0}});var Ve=globalThis&&globalThis.__rest||function(t,a){var x={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.indexOf(l)<0&&(x[l]=t[l]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,l=Object.getOwnPropertySymbols(t);o<l.length;o++)a.indexOf(l[o])<0&&Object.prototype.propertyIsEnumerable.call(t,l[o])&&(x[l[o]]=t[l[o]]);return x};const Oe=t=>{const{getPrefixCls:a,direction:x,divider:l}=r.useContext(ye),{prefixCls:o,type:j="horizontal",orientation:i="center",orientationMargin:h,className:V,rootClassName:P,children:w,dashed:E,plain:S,style:A}=t,u=Ve(t,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","plain","style"]),C=a("divider",o),[p,k,O]=ze(C),$=i.length>0?`-${i}`:i,D=!!w,m=i==="left"&&h!=null,n=i==="right"&&h!=null,Y=ve(C,l==null?void 0:l.className,k,O,`${C}-${j}`,{[`${C}-with-text`]:D,[`${C}-with-text${$}`]:D,[`${C}-dashed`]:!!E,[`${C}-plain`]:!!S,[`${C}-rtl`]:x==="rtl",[`${C}-no-default-orientation-margin-left`]:m,[`${C}-no-default-orientation-margin-right`]:n},V,P),U=r.useMemo(()=>typeof h=="number"?h:/^\d+$/.test(h)?Number(h):h,[h]),K=Object.assign(Object.assign({},m&&{marginLeft:U}),n&&{marginRight:U});return p(r.createElement("div",Object.assign({className:Y,style:Object.assign(Object.assign({},l==null?void 0:l.style),A)},u,{role:"separator"}),w&&j!=="vertical"&&r.createElement("span",{className:`${C}-inner-text`,style:K},w)))},re=Oe,Te=t=>{const a=J(),[x]=f.useForm(),[l,o]=r.useState(!1),[j,i]=r.useState([]),[h,V]=r.useState([]),[P,w]=r.useState([]),[E,S]=r.useState([]),A=j.length>0&&j.length<h.length,u=h.length===j.length,C=()=>{a(G());const m=x.getFieldsValue();v.saveLogroAprendizaje(m).then(n=>{n.data.ok&&(t.setData(),t.cerrar())}).catch(n=>{console.log(n),a(y({success:!1,title:"Error al agregar logro de aprendizaje",message:n.response.data.error}))}).finally(()=>{a(q())})},p=()=>{o(!0);const m=x.getFieldsValue();v.obtenerMaterias(m).then(n=>{n.data.ok&&V(n.data.data)}).catch(n=>{console.log(n),a(y({success:!1,title:"Error al obtetner las materias",message:n.response.data.error}))}).finally(()=>{o(!1)})},k=m=>{i(m)},O=m=>{i(m.target.checked?h.map(n=>n.value):[])};console.log(j),r.useEffect(()=>{x.setFieldsValue({materias:j})},[j]);const $=()=>{a(G()),v.getComboCarreras().then(m=>{m.data.ok&&w(m.data.data)}).catch(m=>{console.log(m),a(y({success:!1,title:"Error al asignar los logros",message:m.response.data.error}))}).finally(()=>a(q()))};r.useEffect(()=>{$()},[]);const D=m=>{v.obtenerPeriodoNominaCarreraDocenteMateria(m).then(n=>{n.data.ok&&S(n.data.data)}).catch(n=>{console.log(n),a(y({success:!1,title:"Error al obtetner los periodos",message:n.response.data.error}))})};return e.jsx(oe,{footer:"",title:t.title,open:t.status,onCancel:t.cerrar,children:e.jsxs(f,{form:x,layout:"vertical",onFinish:C,children:[e.jsxs(F,{children:[e.jsx(M,{style:{width:"100%"},children:e.jsx(f.Item,{label:"Descripcion del logro",name:"descripcion",rules:[{required:!0,message:"Por favor ingrese una descripcion"}],children:e.jsx(me,{})})}),e.jsx(M,{style:{width:"100%"},children:e.jsx(f.Item,{label:"Carreras",name:"carrera",rules:[{required:!0,message:"Seleccione una carrera"}],children:e.jsx(W,{placeholder:"Seleccione una carrera...",options:P,onChange:D})})}),e.jsx(M,{style:{width:"100%"},children:e.jsx(f.Item,{label:"Periodos",name:"periodos",rules:[{required:!0,message:"Seleccione un periodo"}],children:e.jsx(W,{placeholder:"Seleccione un periodo...",options:E,onChange:p})})})]}),e.jsx(F,{children:e.jsx(M,{style:{width:"100%"},children:e.jsx(N,{styles:{title:{overflow:"visible"}},title:e.jsxs(F,{justify:"space-between",children:[e.jsx(R,{offset:[15,0],count:h.length,children:e.jsx("span",{children:"Materias"})})," ",j.length>0&&e.jsx(R,{count:j.length,children:"Seleccionados"})," "]}),children:l?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):h.length>0?e.jsxs(e.Fragment,{children:[e.jsx(_,{indeterminate:A,onChange:O,checked:u,children:"Seleccionar todos"}),e.jsx(re,{}),e.jsx(f.Item,{style:{height:"200px",overflowY:"auto"},name:"materias",rules:[{required:!0,message:"Seleccione las materias"}],children:e.jsx(_.Group,{style:{display:"flex",flexDirection:"column"},onChange:k,value:j,options:h})})]}):e.jsx(Q,{})})})}),e.jsx(F,{justify:"end",children:e.jsxs(M,{children:[e.jsx(z,{type:"primary",style:{marginInline:"10px"},htmlType:"submit",children:"Guardar"}),e.jsx(z,{onClick:t.cerrar,children:"Cerrar"})]})})]})})},De=t=>{const a=J(),[x]=f.useForm();r.useEffect(()=>{Object.keys(t.data).length>0&&x.setFieldsValue({descripcion:t.data.descripcion})},[t.data]);const l=()=>{a(G());const o=x.getFieldsValue();v.modificarLogroAprendizaje({id_logros:t.data.id_logros,descripcion:o.descripcion}).then(j=>{j.data.ok&&(t.setData(i=>i.map(h=>h.id_logros===t.data.id_logros?{...h,descripcion:o.descripcion}:h)),t.cerrar())}).catch(j=>{a(y({success:!1,title:"Error al agregar logro de aprendizaje",message:j.response.data.error}))}).finally(()=>{a(q())})};return e.jsx(oe,{footer:"",title:t.title,open:t.status,onCancel:t.cerrar,children:e.jsxs(f,{form:x,layout:"vertical",onFinish:l,children:[e.jsx(F,{children:e.jsx(M,{style:{width:"100%"},children:e.jsx(f.Item,{label:"Descripcion del logro",name:"descripcion",children:e.jsx(me,{})})})}),e.jsx(F,{justify:"end",children:e.jsxs(M,{children:[e.jsx(z,{type:"primary",style:{marginInline:"10px"},htmlType:"submit",children:"Guardar"}),e.jsx(z,{onClick:t.cerrar,children:"Cerrar"})]})})]})})},ge=t=>e.jsx(oe,{open:t.status,onCancel:t.cerrar,footer:null,children:e.jsx(Se,{status:"warning",title:t.title,subTitle:t.message,extra:e.jsxs(F,{justify:"center",children:[e.jsx(M,{style:{marginInline:"10px"},children:e.jsxs(z,{type:"primary",onClick:t.funcion,children:[e.jsx(ne,{}),"Aceptar"]})}),e.jsx(M,{style:{marginInline:"10px"},children:e.jsxs(z,{onClick:t.cerrar,children:[e.jsx(ke,{}),"Cancelar"]})})]})})}),Be=()=>{const[t]=f.useForm(),a=J(),[x,l]=r.useState([]),[o,j]=r.useState([]),[i,h]=r.useState([]),[V,P]=r.useState([]),[w,E]=r.useState(!1),[S,A]=r.useState(!1),[u,C]=r.useState([]),[p,k]=r.useState([]),[O,$]=r.useState({}),[D,m]=r.useState(!1);r.useEffect(()=>{t.setFieldsValue({materias:u,logros:p})},[u,p]);const n=u.length>0&&u.length<o.length,Y=o.length===u.length,U=p.length>0&&p.length<i.length,K=i.length===p.length,Z=()=>{a(G()),v.getComboCarreras().then(g=>{g.data.ok&&l(g.data.data)}).catch(g=>{console.log(g),a(y({success:!1,title:"Error al asignar los logros",message:g.response.data.error}))}).finally(()=>a(q()))},ee=(g,s)=>{$(s),E(!0),A(!0);const b=t.getFieldsValue();v.obtenerMaterias(b).then(I=>{I.data.ok&&(j(I.data.data),ae())}).catch(I=>{console.log(I),a(y({success:!1,title:"Error al obtetner las materias",message:I.response.data.error}))}).finally(()=>{E(!1)})},te=g=>{v.obtenerPeriodoNominaCarreraDocenteMateria(g).then(s=>{s.data.ok&&P(s.data.data)}).catch(s=>{console.log(s),a(y({success:!1,title:"Error al obtetner los periodos",message:s.response.data.error}))})},ae=()=>{A(!0),v.obtenerLogrosAprendizaje().then(g=>{console.log(g),h(g.data.data.map((s,b)=>({value:s.id_logros,label:e.jsxs(e.Fragment,{children:[e.jsx(de,{color:"green",children:s.codigo}),s.descripcion]})})))}).catch(g=>{a(y({success:!1,title:"Error al obtener logros",message:g.response.data.error}))}).finally(()=>A(!1))},se=g=>{C(g)},c=g=>{C(g.target.checked?o.map(s=>s.value):[])},d=g=>{k(g)},H=g=>{k(g.target.checked?i.map(s=>s.value):[])},T=()=>{a(G());const g=t.getFieldsValue();v.asignarLogrosAprendizajeMasivo(g).then(s=>{s.data.ok&&(a(y({success:!0,title:"Asignacion de logros masivo exitoso!"})),m(!1),C([]),k([]),t.resetFields())}).catch(s=>{a(y({success:!1,title:"Error al asignar logros masivamente",message:s.response.data.error}))}).finally(()=>a(q()))};r.useEffect(()=>{Z()},[]);const ie=o.filter(g=>u.includes(g.value)).map((g,s)=>({...g,key:s,accion:e.jsx(ue,{title:"Quitar de la lista",children:e.jsx(Ie,{onClick:()=>C(u.filter(b=>b!==g.value)),style:{color:"#FC7F80",fontSize:"20px"}})})}));return e.jsxs("div",{children:[e.jsx(ge,{status:D,cerrar:()=>m(!1),title:"Atencion!",message:e.jsxs(e.Fragment,{children:["Esta seguro que desea continuar, se remplazaran los logros de las siguientes materias, en el siguiente periodo:",e.jsx(xe,{dataSource:ie,columns:[{dataIndex:"label",title:O.label},{dataIndex:"accion",title:"",width:50}],pagination:!1,scroll:{y:240}})]}),funcion:()=>T()}),e.jsx(ce,{type:"warning",message:e.jsx("b",{children:"ATENCION!"}),description:"Se sustituiran los logros de aprendizaje de las materias seleccionadas, en el periodo seleccionado",showIcon:!0}),e.jsxs(f,{form:t,layout:"vertical",children:[e.jsx(f.Item,{label:"Carreras",name:"carrera",children:e.jsx(W,{placeholder:"Seleccione una carrera...",options:x,onChange:te})}),e.jsx(f.Item,{label:"Periodos",name:"periodos",children:e.jsx(W,{placeholder:"Seleccione un periodo...",options:V,onChange:ee})}),e.jsxs(F,{justify:"space-between",children:[e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(N,{title:e.jsxs(F,{justify:"space-between",children:[e.jsxs("span",{children:["Materias",e.jsx(R,{count:o.length})]})," ",u.length>0&&e.jsxs("span",{children:["Seleccionados",e.jsx(R,{count:u.length})]})," "]}),children:w?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):o.length>0?e.jsxs(e.Fragment,{children:[e.jsx(_,{indeterminate:n,onChange:c,checked:Y,children:"Seleccionar todos"}),e.jsx(re,{}),e.jsx(f.Item,{style:{height:"200px",overflowY:"auto"},name:"materias",children:e.jsx(_.Group,{style:{display:"flex",flexDirection:"column"},onChange:se,value:u,options:o})})]}):e.jsx(Q,{})})}),e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(N,{title:e.jsxs(e.Fragment,{children:["Logros de aprendizaje",e.jsx(R,{count:p.length})," "]}),children:S?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):i.length>0?e.jsxs(e.Fragment,{children:[e.jsx(_,{indeterminate:U,onChange:H,checked:K,children:"Seleccionar todos"}),e.jsx(re,{}),e.jsx(f.Item,{style:{height:"200px",overflowY:"auto"},name:"logros",children:e.jsx(_.Group,{style:{display:"flex",flexDirection:"column"},onChange:d,options:i})})]}):e.jsx(Q,{})})})]}),e.jsx(F,{justify:"end",children:e.jsxs(z,{onClick:()=>m(!0),htmlType:"submit",disabled:!(u.length>0&&p.length>0),type:"primary",style:{marginBlock:"15px"},children:[e.jsx(ne,{}),"  Asignar logros"]})})]})]})},Ne=()=>{const[t]=f.useForm(),a=J(),[x,l]=r.useState([]),[o,j]=r.useState([]),[i,h]=r.useState({}),[V,P]=r.useState({}),[w,E]=r.useState(!1),[S,A]=r.useState([]),[u,C]=r.useState([]),[p,k]=r.useState([]),[O,$]=r.useState(!1),D=S.length>0&&S.length<o.length,m=o.length===S.length,n=()=>{a(G()),v.getComboCarreras().then(c=>{c.data.ok&&l(c.data.data)}).catch(c=>{console.log(c),a(y({success:!1,title:"Error al asignar los logros",message:c.response.data.error}))}).finally(()=>a(q()))},Y=c=>{v.obtenerPeriodoNominaCarreraDocenteMateria(c).then(d=>{d.data.ok&&k(d.data.data)}).catch(d=>{console.log(d),a(y({success:!1,title:"Error al obtener los periodos",message:d.response.data.error}))})},U=(c,d)=>{h(d),E(!0);const H=t.getFieldsValue();v.obtenerMateriasConLogros({periodos:H.periodo_referencio,carrera:H.carrera}).then(T=>{T.data.ok&&j(T.data.data)}).catch(T=>{console.log(T),a(y({success:!1,title:"Error al obtener las materias",message:T.response.data.error}))}).finally(()=>{E(!1),K()})},K=()=>{const c=t.getFieldsValue();v.obtenerLogrosPeriodo({periodos:c.periodo_referencio,carrera:c.carrera}).then(d=>{d.data.ok&&(console.log(d.data.data),C(d.data.data))}).catch(d=>{console.log(d),a(y({success:!1,title:"Error al obtener los logros por periodo y carrera",message:d.response.data.error}))})},Z=c=>{A(c)},ee=c=>{A(c.target.checked?o.map(d=>d.value):[])};r.useEffect(()=>{n()},[]),r.useEffect(()=>{t.setFieldsValue({materias:S})},[S]);const te=()=>{a(G());const c=t.getFieldsValue();v.clonarLogrosPorPeriodo(c).then(d=>{d.data.ok&&(a(y({success:!0,title:"Datos clonados exitosamente!"})),$(!1),t.resetFields(),A([]),j([])),console.log(d)}).catch(d=>{a(y({success:!1,title:"Error al obtener las materias",message:d.response.data.error}))}).finally(()=>a(q()))},ae=p.map((c,d)=>({...c,key:d,disabled:c.value===i.value})),se=u==null?void 0:u.filter(c=>S.includes(c.id_materia)).map((c,d)=>({title:c.materia,key:`${d}-${c.id_materia}`,children:c.logros.map((H,T)=>({key:`${d}-${c.id_materia}-${T}`,title:e.jsxs(e.Fragment,{children:[e.jsx(de,{color:"green",children:H.codigo_logro})," ",H.logro]})}))}));return e.jsxs("div",{children:[e.jsx(ge,{status:O,cerrar:()=>$(!1),title:"¿Esta seguro que desea continuar?",message:e.jsxs(e.Fragment,{children:["Se asignaran los logros de las materias seleccionadas del periodo ",e.jsx("b",{children:i.label})," , en el siguiente periodo: ",e.jsx("b",{children:V.label})]}),funcion:()=>te()}),e.jsx(ce,{type:"warning",message:e.jsx("b",{children:"ATENCION!"}),description:"Si las materias del periodo seleccionado tiene logros al momento de clonarla, estos se sustituiran por los logros de referencia asignado",showIcon:!0}),e.jsxs(f,{form:t,layout:"vertical",children:[e.jsx(f.Item,{label:"Carreras",name:"carrera",children:e.jsx(W,{placeholder:"Seleccione una carrera...",options:x,onChange:Y})}),e.jsxs(F,{justify:"space-between",children:[e.jsx(M,{xs:11,sm:11,md:11,lg:11,xl:11,children:e.jsx(f.Item,{label:"Periodo referencia",name:"periodo_referencio",children:e.jsx(W,{placeholder:"Seleccione un periodo...",onChange:U,options:p})})}),e.jsx(M,{xs:11,sm:11,md:11,lg:11,xl:11,children:e.jsx(f.Item,{label:"Periodo nuevo",name:"periodo",children:e.jsx(W,{disabled:!Object.keys(i).length>0,placeholder:"Seleccione un periodo...",options:ae,onChange:(c,d)=>P(d)})})})]}),e.jsxs(F,{justify:"space-between",children:[e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(N,{title:e.jsxs(e.Fragment,{children:["Materias",e.jsx(R,{count:o.length})," "]}),children:w?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):o.length>0?e.jsxs(e.Fragment,{children:[e.jsx(_,{indeterminate:D,onChange:ee,checked:m,children:"Seleccionar todos"}),e.jsx(re,{}),e.jsx(f.Item,{style:{height:"200px",overflowY:"auto"},name:"materias",children:e.jsx(_.Group,{style:{display:"flex",flexDirection:"column"},onChange:Z,options:o})})]}):e.jsx(Q,{})})}),e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(N,{title:e.jsxs(e.Fragment,{children:["Vista Previa",e.jsx(R,{count:S.length})," "]}),children:S.length>0?e.jsx(e.Fragment,{children:e.jsx(le,{showLine:!0,height:295,defaultExpandAll:!0,treeData:se})}):e.jsx(Q,{})})})]}),e.jsx(F,{justify:"end",children:e.jsx(M,{style:{marginBlock:"20px"},children:e.jsxs(z,{type:"primary",disabled:!S.length>0,onClick:()=>$(!0),children:[" ",e.jsx(ne,{})," Clonar logros"]})})})]})]})},_e=()=>{const[t]=f.useForm(),a=J(),[x,l]=r.useState([]),[o,j]=r.useState([]),[i,h]=r.useState([]),[V,P]=r.useState([]),[w,E]=r.useState(!1),[S,A]=r.useState(!1),[u,C]=r.useState([]),[p,k]=r.useState([]),[O,$]=r.useState(!1),[D,m]=r.useState(!1),[n,Y]=r.useState({}),U=n[u]?n[u].length>0&&n[u].length<i.length:!1,K=n[u]?i.length===n[u].length:!1,Z=()=>{a(G()),v.getComboCarreras().then(s=>{s.data.ok&&l(s.data.data)}).catch(s=>{console.log(s),a(y({success:!1,title:"Error al asignar los logros",message:s.response.data.error}))}).finally(()=>a(q()))},ee=(s,b)=>{E(!0),A(!0);const I=t.getFieldsValue();t.resetFields(["materias","logros"]),C([]),k([]),c(),v.obtenerMaterias(I).then(B=>{B.data.ok&&(j(B.data.data),ae())}).catch(B=>{console.log(B),a(y({success:!1,title:"Error al obtetner las materias",message:B.response.data.error}))}).finally(()=>{E(!1)})},te=s=>{v.obtenerPeriodoNominaCarreraDocenteMateria(s).then(b=>{b.data.ok&&P(b.data.data)}).catch(b=>{console.log(b),a(y({success:!1,title:"Error al obtetner los periodos",message:b.response.data.error}))})},ae=()=>{A(!0),v.obtenerLogrosAprendizaje().then(s=>{h(s.data.data.map((b,I)=>({value:b.id_logros,label:e.jsxs(e.Fragment,{children:[e.jsx(de,{color:"green",children:b.codigo}),b.descripcion]})})))}).catch(s=>{a(y({success:!1,title:"Error al obtener logros",message:s.response.data.error}))}).finally(()=>A(!1))},se=()=>{a(G());const s=t.getFieldValue();v.asignarLogrosPorMateria({carrera:s.carrera,periodo:s.periodos,data:n}).then(b=>{b.data.ok&&a(y({success:!0,title:"Asignación de logros por materia exitoso!"}))}).catch(b=>{a(y({success:!1,title:"Error al obtener logros",message:b.response.data.error}))}).finally(()=>{a(q()),$(!1)})},c=()=>{const s=t.getFieldsValue();v.obtenerMateriasLogrosPeriodo(s).then(b=>{Y(b.data.data)}).catch(b=>{a(y({success:!1,title:"Error al obtener los logros asignados al periodo por materia",message:b.response.data.error}))})},d=s=>{C(s.target.value),t.setFieldsValue({logros:n[s.target.value]}),k(n[s.target.value]?n[s.target.value]:[])},H=s=>{k(s)},T=s=>{const b=s.target.checked?i.map(I=>I.value):[];k(s.target.checked?i.map(I=>I.value):[]),t.setFieldsValue({logros:b})};r.useEffect(()=>{Z()},[]),r.useEffect(()=>{const s=t.getFieldsValue();s.materias!==void 0&&s.logros!==void 0&&Y({...n,[s.materias]:p})},[p]);const ie=Object.keys(n).map(s=>parseInt(s,10)),g=o.filter(s=>ie.includes(s.value)).map((s,b)=>{const I=i.filter(B=>n[s.value].includes(B.value)).map(B=>({title:B.label,key:B.value+"-"+s.value}));return{title:s.label,key:s.value,children:I}});return e.jsxs("div",{children:[e.jsxs(oe,{title:"Vista previa",open:D,onCancel:()=>m(!1),footer:"",children:[e.jsx(N,{children:e.jsx(le,{showLine:!0,height:295,treeData:g})}),e.jsx(F,{justify:"end",children:e.jsx(z,{style:{marginTop:"20px"},onClick:()=>m(!1),children:"Cerrar"})})]}),e.jsx(ge,{status:O,cerrar:()=>$(!1),title:"Atencion!",message:e.jsxs(e.Fragment,{children:["¿Esta seguro que desea continuar?",e.jsx(N,{children:e.jsx(le,{showLine:!0,height:295,treeData:g})})]}),funcion:()=>se()}),e.jsxs(f,{form:t,layout:"vertical",children:[e.jsx(f.Item,{label:"Carreras",name:"carrera",children:e.jsx(W,{placeholder:"Seleccione una carrera...",options:x,onChange:te})}),e.jsx(f.Item,{label:"Periodos",name:"periodos",children:e.jsx(W,{placeholder:"Seleccione un periodo...",options:V,onChange:ee})}),e.jsxs(F,{justify:"space-between",children:[e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(N,{styles:{title:{overflow:"visible"}},title:e.jsxs(F,{justify:"space-between",children:[e.jsxs("span",{style:{marginTop:"5px"},children:["Materias",e.jsx(R,{offset:[2,-20],count:o.length})]})," ",Object.keys(n).length>0&&e.jsx(R,{offset:[-1,5],count:Object.keys(n).length,children:e.jsx(z,{onClick:()=>m(!0),type:"primary",children:"Vista Previa"})})," "]}),children:w?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):o.length>0?e.jsx(e.Fragment,{children:e.jsx(f.Item,{style:{height:"200px",overflowY:"auto"},name:"materias",children:e.jsx(Le.Group,{options:o,onChange:d,value:u,style:{display:"flex",flexDirection:"column",padding:"1px"},optionType:"button",buttonStyle:"solid"})})}):e.jsx(Q,{})})}),e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(N,{styles:{title:{overflow:"visible"}},title:e.jsxs(e.Fragment,{children:["Logros de aprendizaje",e.jsx(R,{offset:[2,-20],count:p.length})," "]}),children:S?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):i.length>0?e.jsxs(e.Fragment,{children:[e.jsx(_,{indeterminate:U,onChange:T,checked:K,children:"Seleccionar todos"}),e.jsx(re,{}),e.jsx(f.Item,{style:{height:"130px",overflowY:"auto"},name:"logros",children:e.jsx(_.Group,{style:{display:"flex",flexDirection:"column"},onChange:H,options:i})})]}):e.jsx(Q,{})})})]}),e.jsx(F,{justify:"end",children:e.jsxs(z,{onClick:()=>$(!0),htmlType:"submit",disabled:!Object.keys(n).length>0,type:"primary",style:{marginBlock:"15px"},children:[e.jsx(ne,{}),"  Asignar logros"]})})]})]})},rt=()=>{const[t,a]=r.useState(!1),[x,l]=r.useState(!1),[o,j]=r.useState({}),[i,h]=r.useState(1),[V,P]=r.useState([]),w=J(),E=[{align:"center",key:"codigo",dataIndex:"codigo",title:"Codigo"},{align:"center",key:"descripcion",dataIndex:"descripcion",title:"Descripción"},{align:"center",key:"accion",dataIndex:"accion",title:"Acción"}],S=()=>{switch(i){case 1:w(G()),v.obtenerLogrosAprendizaje().then(p=>{p.data.ok&&P(p.data.data.map((k,O)=>({key:O,id_logros:k.id_logros,descripcion:k.descripcion,codigo:k.codigo,accion:e.jsx(ue,{title:"Modificar descripcion",children:e.jsx(Me,{onClick:()=>{l(!0),j(k)}})})})))}).catch(p=>{console.log(p),w(y({success:!1,title:"Error al agregar logro de aprendizaje",message:p.response.data.error}))}).finally(()=>{w(q())});break}};r.useEffect(()=>{S()},[i]);const A=p=>{h(p)},u=[{key:"2.1",label:"Asignación por materia",children:e.jsx(_e,{})},{key:"2.2",label:"Asignación masiva",children:e.jsx(Be,{})},{key:"2.3",label:"Clonar desde periodo",children:e.jsx(Ne,{})}],C=[{key:"1",label:"Logros aprendizaje",children:e.jsxs(e.Fragment,{children:[e.jsx(De,{cerrar:()=>l(!1),setData:P,data:o,status:x,title:"Modificar logro de aprendizaje"}),e.jsx(F,{justify:"end",style:{margin:"10px"},children:e.jsx(z,{type:"primary",onClick:()=>a(!0),children:"Agregar Logro "})}),e.jsx(Te,{cerrar:()=>a(!1),setData:S,status:t,title:"Agregar logro de aprendizaje"}),e.jsx(xe,{columns:E,dataSource:V})]})},{key:"2",label:"Asignar logros por materia",children:e.jsx(he,{items:u})}];return e.jsxs("div",{children:[e.jsx("h2",{children:"Gestion de logros de aprendizaje"}),e.jsxs(N,{children:[e.jsx(ce,{style:{marginBlock:"10px"},message:e.jsxs(e.Fragment,{children:["Aqui se mostraran los datos de los archivos ingresados en el ",e.jsx("b",{children:"REPORTE NOMINA CARRERA DOCENTE MATERIA"})]}),type:"info",showIcon:!0,closable:!0}),e.jsx(he,{onChange:A,items:C})]})]})};export{rt as default};
